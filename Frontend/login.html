<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Login</title>
  <link rel="stylesheet" href="login.css">
</head>
<body>
  <div class="container">
    <h1>Log in</h1>

    <!-- Login Form -->
    <form id="loginForm">
      <label>Email</label>
      <input id="email" type="email" required />

      <label>Password</label>
      <input id="password" type="password" required />

      <div class="row">
        <button type="submit">Log in</button>
        <a class="link" href="signup.html">Create account</a>
      </div>

     
      <div id="msg" class="alert"></div>
    </form>
  </div>

  <script>
    const base = '/api'; 

    
    document.getElementById('loginForm').onsubmit = async (e) => {
      e.preventDefault(); 

      
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      try {
        
        const res = await fetch(base + '/auth/login', {
          method:'POST',
          headers:{ 'Content-Type':'application/json' },
          body: JSON.stringify({ email, password })
        });

        
        const data = await res.json();

        
        if (!res.ok) {
          document.getElementById('msg').textContent = data.error || 'Login failed';
          return;
        }

        
        localStorage.setItem('token', data.token);
        window.location = 'stores.html';

      } catch (err) {
        
        document.getElementById('msg').textContent = 'Network error. Please try again.';
      }
    };
  </script>
</body>
</html>
